package cmd

import (
	"fmt"
	"io/ioutil"
	"strings"
	"os"
	"github.com/spf13/cobra"
	"github.com/russross/blackfriday"
)

func init(){
	RootCmd.AddCommand(markdown4htmlCmd)
}

var markdown4htmlCmd = &cobra.Command{
	Use:	"mh",
	Short:	"input:markdown, output:html",
	Long:	"markdown convert to html",
	Run: func(cmd *cobra.Command, args []string){
		md, err := ioutil.ReadFile(string(args[0]))
		if err != nil {
			fmt.Print(err)
		}
		html := blackfriday.MarkdownBasic(md)
		dir, err := os.Getwd()
		initfile, err := os.Open("test.html")//	今後弄る
		if err != nil {
			fmt.Print(err)
		}
		fmt.Print(initfile)
		defer initfile.Close()
		file, err := os.OpenFile(dir + "/" +string(args[1]), os.O_CREATE|os.O_APPEND|os.O_RDWR,0666)
		if err != nil {
			fmt.Print(err)
		}
		defer file.Close()

		
		fmt.Fprintln(file, "%v\n", strings.Join(html, " "))
	},
}
